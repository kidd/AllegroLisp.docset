<html><head><meta name="viewport" content="width=device-width, initial-scale=1"> <meta http-equiv="content-type" name="description" content="text/html; charset=UTF-8"> <link rel="stylesheet" href="../../acldoc-styles.css" type="text/css"><title>top-level-read-eval-print-loop</title></head><body><table border="0" width="100%" cellpadding="1" cellspacing="0"><tr><td colspan="2" bgcolor="#00FFFF"><table border="0" cellpadding="5" cellspacing="3"><tr><td align="left" bgcolor="#00FFFF"><b>Function</b></td><td align="left" bgcolor="#00FFFF"><b>Package: top-level</b></td><td align="center" bgcolor="#00FFFF"><a href="../../contents.htm"><b>ToC</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../introduction.htm"><b>DocOverview</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../cgide.htm"><b>CGDoc</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../release-notes.htm"><b>RelNotes</b></a></td><td align="center" bgcolor="#00FFFF"><a href="http://www.franz.com/support/faq/"><b>FAQ</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../index.htm"><b>Index</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../permuted-index.htm"><b>PermutedIndex</b></a></td></tr></table></td><td align="right"><b>Allegro CL version 10.1</b><br><small><a href="../../introduction.htm#updates-s">Unrevised from 10.0 to 10.1.</a></small><br><a href="http://www.franz.com/support/documentation/10.0/doc/operators/tpl/top-level-read-eval-print-loop.htm">10.0 version</a></td></tr></table><h2 id="2">top-level-read-eval-print-loop</h2>

<p id="3"><b>Arguments: </b><i>
</i></p>

<p id="4">
Although the basic algorithm of a Lisp listener is a simple
repetition of
</p>

<pre id="5">
(print (eval (read))) 
</pre>

<p id="6">
it is greatly complicated by the need to handle command history, error
levels, and other useful features. When an application needs a Lisp
listener, often it will be simplest to use this, the default Lisp
listener provided by the Allegro CL top level. It takes no arguments,
but must be run inside a <a href="start-interactive-top-level.htm"><b>start-interactive-top-level</b></a>
function. This function does not return. Listeners stop through a
non-local exit (triggered, for example, by a call to <a href="../excl/exit.htm"><b>exit</b></a>).
</p>

<p id="7">
The Allegro CL idiom for running a standard Lisp listener
communicating with <a href="../../../ansicl/dictentr/terminal.htm"><code>*terminal-io*</code></a> (this might be done in a <a href="../../variables/excl/s_restart-app-function_s.htm"><code>*restart-app-function*</code></a>) looks
something like this:
</p>

<pre id="8">
(tpl:start-interactive-top-level *terminal-io* 
       #'tpl:top-level-read-eval-print-loop
        nil)
</pre>

<p id="9">
And the idiom for running a standard Lisp listener inside a window
looks something like this:
</p>

<pre id="10">
(process-run-function "My Lisp Listener"
     #'tpl:start-interactive-top-level
     my-window-stream
     #'tpl:top-level-read-eval-print-loop
       nil)
</pre>

<p id="11">Entry to <a href="top-level-read-eval-print-loop.htm"><b>top-level-read-eval-print-loop</b></a>
establishes additional bindings for certain variables used by the top
level loop. These bindings are established inside any bindings
established by <a href="start-interactive-top-level.htm"><b>start-interactive-top-level</b></a>.  The
variables and initial binding values are taken from the alist bound to
the variable <a href="../../variables/tpl/s_default-lisp-listener-bindings_s.htm"><code>*default-lisp-listener-bindings*</code></a>.
</p>

<p id="12">
An operator with this name but with a different definition is used in
a Lisp image built with a minimal top level, that is built with the
<i>include-tpl</i> argument to <a href="../excl/build-lisp-image.htm"><b>build-lisp-image</b></a> specified <code>nil</code>. See <a href="../../building-images.htm#minimal-top-levels-1">Minimal top levels</a> in
<a href="../../building-images.htm">building-images.htm</a> for information on minimal top
levels. Follow the link to see the definition (Lisp source code) of
<a href="top-level-read-eval-print-loop.htm"><b>top-level-read-eval-print-loop</b></a> in a
minimal top level.
</p>

<p id="13">
See <a href="../../top-level.htm">top-level.htm</a>
for more information on the top level.
</p>

<hr><p id="14"><small>Copyright (c) 1998-2017, Franz Inc. Oakland, CA., USA. All rights reserved.</small><br>
<small>This page was not revised from the 10.0 page.</small><br><small>Created 2017.2.15.</small><br>
</p><table border="0" width="100%" cellpadding="1" cellspacing="0"><tr><td colspan="2" bgcolor="#00FFFF"><table border="0" cellpadding="5" cellspacing="3"><tr><td align="left" bgcolor="#00FFFF"></td><td align="left" bgcolor="#00FFFF"></td><td align="center" bgcolor="#00FFFF"><a href="../../contents.htm"><b>ToC</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../introduction.htm"><b>DocOverview</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../cgide.htm"><b>CGDoc</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../release-notes.htm"><b>RelNotes</b></a></td><td align="center" bgcolor="#00FFFF"><a href="http://www.franz.com/support/faq/"><b>FAQ</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../index.htm"><b>Index</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../permuted-index.htm"><b>PermutedIndex</b></a></td></tr></table></td><td align="right"><b>Allegro CL version 10.1</b><br><small><a href="../../introduction.htm#updates-s">Unrevised from 10.0 to 10.1.</a></small><br><a href="http://www.franz.com/support/documentation/10.0/doc/operators/tpl/top-level-read-eval-print-loop.htm">10.0 version</a></td></tr></table></body></html>